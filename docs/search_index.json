[
["index.html", "STA 141 - Exploratory Data Analysis and Visualization Preface 0.1 Instructional Material 0.2 Data Sources 0.3 Introduction 0.4 Pedigogical Plan", " STA 141 - Exploratory Data Analysis and Visualization Derek L. Sonderegger February 20, 2020 Preface These are the lecture notes for STA 141 - Exploratory Visual Data Analysis. This course is intended to teach students how to think critically about problems, examine data that can provide answers, and create graphs that are insightful, and ask follow-up questions to the visual analysis. Also, because disinformation can be disguised to seem credible, students will also be exposed to various data visualization tricks and statistical malarkey that propagandists. The source code for my notes, homework assignments, and other information is available on my on GitHub. In particular, there is a directory data-raw that contains all of the datasets that we’ll use in these notes and homeworks. 0.1 Instructional Material This course draws information from several websites and books. Alberto Cairo’s book The Truthful Art. Alberto Cairo is the Knight Chair in Visual Journalism at the School of Communication of the University of Miami (UM), where he heads specializations in infographics and data visualization. You can find more about him at thefunctionalart.com. Also at his website, his blog highlights data visualizations in the news. Many of the graphs I will shown in this class are featured here. Claus O. Wilke has a book Fundamentals of Data Visualization. There is an online pre-print version of the book available here as well as GitHub repositories for the book source and data used in the book. He also has a nice R package called cowplot that aids in making publication ready graphs using R’s ggplot2. Calling Bullshit This is a 3-credit course taught at University of Washington. Their goal is to teach students to recognize bullshit provide another scientist a reason why a claim is bullshit. Amelia McNamara’s SDS 136 course. Amelia is an Assistant Professor at University of St Thomas and I’ve been influenced by her presentations at national conferences. These are her notes from a data visualization course that she teaches. She is also pretty fun to follow on twitter. 0.2 Data Sources The website Our World in Data has tried to bring together huge amounts of information about a variety of topics and presents the data in context. It typically addresses socioeconomic issues. The website Kaggle started out as a repository for data sets in which data scientists would have host informal competitions. It has grown to host thousands of data sets covering a wide variety of issues. The Gapminder website has health and socioeconomic data for counties going back in time. Access data from the US Government from Data.gov The Centers for Disease Control Vital Stats allows for direct download of commonly used downloads. The CDC’s Wonder on-line access allows you to format data requests for a wide variety of scenarios. 0.3 Introduction Why visualize data? See relationships that raw data obscure. Cognitive work to translate raw numbers into context between other data points are already done for you. Good graphics translate particular numerical relationships into physical relationships which our brains are really good at processing. UK Drug Poison These are the data from the UK related to drug overdose and misuse. Farther down the page gives a similar graph on suicide. Migration Patterns in Europe. While the New York Times is generally really quite good, this graph is quite misleading. Another view of the data is more fair, although the still depressing. I feel compelled to show a bad 3-d Excel graphic as well. Reuter’s infamous gun deaths in Florida chart. 0.4 Pedigogical Plan Develop basic understanding and skills about data wrangling. Because this course will require you to find data that interests you, we need to also learn how to manipulate it because the data are never in a nice format. Introduce the Elementary Perceptual Task order and understand how certain visual tasks are more accurate than others. Introduce a slew of graphic types and examples of where and how they are commonly used. Investigate the choice of variables to display and how that can influence the graph interpretation. Understand how interactive graphics can be used across a broad audience. "],
["1-data-wrangling.html", "Chapter 1 Data Wrangling 1.1 Introduction 1.2 Tableau 1.3 Importing data 1.4 Tidying or Reshaping 1.5 Exercises", " Chapter 1 Data Wrangling 1.1 Introduction The process of data wrangling often seems very situation dependent and there isn’t a unifying process. However this isn’t completely true. The process can be thought of as having four distinct steps. Step Description Import Get the data into software somehow. The structure of the data is just however it came in. Tidy Restructure the data so that each row is an observation, and each column is a variable. Clean Correct variable types, consistent and useful labels, validation and correction. Use Sub-setting the full data into a smaller set that addresses a particular question. In many real world examples, the data wrangling work is concentrated in only one first three steps. Typically you might be able to skip one or more steps, but pedagogically it is helpful to 1.1.1 Tidying The terminology of “tidy data” popularized by Hadley Wickham and his introduction to the concept lives in a vignette in the R tidyr package. I highly recommend reading Hadley Wickhams’s introduction as well as what I present here. Data is usually described as “tidy” if it satisfies the following: Each row represents an observation. Each column represents a variable. Each table of data represents a different type of observational unit. The difficult part is recognizing what constitutes an observation and what constitutes a variable. Often I like to think that the observations represent a noun and each now has multiple variables that adjectives that describe the noun. In particular I think that the attributes should be applicable to every single observation. If your data has a large number of NA values, that is a symptom of storing the data in a messy (non-tidy) format. Suppose I have an address book where I keep email addresses, phone numbers, and other contact information. However, because different people have several different types of contact information, it would be a bad idea to have one row per person because then we’d need a column for work email, personal email, home phone, work phone, cell phone, twitter handle, reddit user name, etc. Instead, store the information with a single row representing a particular contact. Person Type Value Derek Work Email derek.sonderegger@nau.edu Derek Cell Phone 970-867-5309 Derek Twitter @D_Sonderegger Derek Github dereksonderegger Mom Home Phone 555-867-5309 For a more challenging example, suppose we have grade book where we’ve stored students scores for four different homework assignments. name HW.1 HW.2 HW.3 HW.4 Alison 8 5 8 4 Brandon 5 3 6 9 Charles 9 7 9 10 In this case we are considering each row to represent a student and each variable represents homework score. An alternative representation would be for each row to represent a single score. name Assignment Score Alison HW.1 8 Brandon HW.1 5 Charles HW.1 9 Alison HW.2 5 Brandon HW.2 3 Charles HW.2 7 Alison HW.3 8 Brandon HW.3 6 Charles HW.3 9 Alison HW.4 4 Brandon HW.4 9 Charles HW.4 10 Either representation is fine in this case, because each student should have the same number of assignments. However, if I was combining grade books from multiple times I’ve taught the course, the first option won’t work because sometimes I assign projects and sometimes not. So the tidy version of the data would be to have a table scores where each row represents a single assignment from a particular student. 1.1.2 Cleaning The cleaning step is usually highly dependent on the data set content. This step involves Making sure every variable has the right type. For example, make sure that dates are dates, not character strings. Fix factor labels and sort order. Verify numeric values are reasonable. Create (some) calculated variables Most of our data frame manipulation tools are designed to work with tidy data. As a result, cleaning is most easily done after the data set structure has been tidied. Therefore,I recommend first performing the reshaping tidying step and then perform the cleaning. 1.1.3 Use In this step, we concentrate on the research question of interest. Often this involves calculating summary statistics, calculating selecting only particular rows of data, and finally creating graphs and models. 1.2 Tableau Tableau comes with two pieces of software, Tableau Prep and Tableau. The prep software is intended to support the data tidying, cleaning, and summarization steps. Then we save the result to a file and open the cleaned up data in Tableau to do the visualization. This course has access to both Tableau and Tableau Prep through an academic license. Go to https://www.tableau.com/products/prep/download to download both products. Select each product download link to get started. When prompted, enter your school email address for Business E-mail and enter the name of your school for Organization. Activate with your product key which will be distributed via email or on Bblearn. This license will work through the semester. You may continue using Tableau after the class is over by individually requesting their own one-year license through the Tableau for Students program. 1.3 Importing data Often data will be stored in a Comma Separated Values file that has a .csv file suffix. These types of files store data tables, and use a comma to separate the columns. Spreadsheet programs will recognize these files and show columns for Student Name, Exam 1, Exam 2 and the Final Exam. However, if you open these files using a text reader program, they’ll look something like this: Student Name,Exam 1,Exam 2,Final Exam Alice,87,87,81 Bob,91,88,85 Charlie,88,79,92 Below is a video showing how to open up this same data in Tableau Prep. The import step gives a rotated view of the data and generally that doesn’t bother me, but for purposes of show what the imported data looks like, we’ll add a cleaning step that doesn’t do anything but will show the data. In general I won’t keep this step in my cleaning workflow, but it is handy to know how to do this. 1.4 Tidying or Reshaping Often source data is stored in a structure that isn’t useful for subsequent analysis. When the data isn’t a format of one observation per row and one variable per column, we need to fix those issues before proceeding. 1.4.1 Gather When data is in the “wide” format, we might need to convert it into “long” format. For an example, suppose we have a gradebook with a few students. Wide Format Name Exam 1 Exam 2 Final Exam Alison 87 87 81 Bob 91 88 85 Charlie 88 79 92 What we want to do is turn this data frame from a wide data frame into a long data frame. In MS Excel and Tableau, this is called pivoting. Essentially I’d like to create a data frame with three columns: Name, Assessment, and Score. That is to say that each homework datum really has three pieces of information: who it came from, which homework it was, and what the score was. It doesn’t conceptually matter if I store it as 3 rows of 4 columns or 12 rows so long as there is a way to identify how a student scored on a particular homework. So we want to reshape the three Exam columns into just two columns (Assessment and Score). Long Format Name Assessment Score Alison Exam 1 87 Bob Exam 1 91 Charlie Exam 1 88 Alison Exam 2 87 Bob Exam 2 88 Charlie Exam 2 79 Alison Final Exam 81 Bob Final Exam 85 Charlie Final Exam 92 1.4.2 Spread There are times that we need to convert a “long” dataset into “wide” format. This is exactly the reverse function of the gather. Our example will be to undo the gather step from the previous. Again in Tableau, this is called pivoting, but we’ll make sure that we are turning rows into columns. The tricky part is what variable goes into which pivot field. The top box specifies what the new column headers will be and the bottom box specifies what the cell values will be. 1.4.3 Column Splitting Sometimes we have columns where we actually have two pieces of information stored and we have to split the single column into multiple columns. For example, we might have data about across the country, where the city name obnoxiously includes the state. It would be good to split the Name column into City and State columns. For example, Name Population Phoenix, AZ 1660272 Flagstaff, AZ 73964 Tucson, AZ 545975 1.4.4 New Column via Calculation Often we need to take a column and create some sort of calculation. For example, if we are given some information (say student height) in inches, we might want to calculate their height in centimeters by multiplying each height value by \\(2.54\\) and naming the result Height (cm). Student Heights Grade Gender Height Height (cm) 1st Grade Male 44 111.8 1st Grade Male 42 106.7 1st Grade Female 42 106.7 1st Grade Female 40 101.6 12th Grade Male 70 177.8 12th Grade Male 68 172.7 12th Grade Male 69 175.3 12th Grade Female 64 162.6 12th Grade Female 65 165.1 The issue in Tableau is to make sure you remember how to specify a column in a formula. The syntax is [column_name] and then you can use that quantity in whatever formula you want. 1.4.5 Aggregation Given a data set we also want to be able to calculate summary for various columns. For example, we might want to calculate the mean height for each grade level, or perhaps each gender within each grade level. Notice that we end up with a data set with fewer rows. Student Heights: Summarized Grade Gender Avg Height 12th Grade Female 64.5 12th Grade Male 69 1st Grade Female 41 1st Grade Male 43 1.4.6 New Column with Aggregation There are many cases where we need to create a calculated column, but the calculation involves some aggregated information. For, if have the number of males and females in each grade and we want to calculate the percentage of males and females in each grade. To do this we need to aggregate data to count the number of students in each grade and then divide the number of males or females in each grade by the total number of students in the grade. Student Heights: Summarized Grade Gender Grade_Gender_n 12th Grade Female 2 12th Grade Male 3 1st Grade Female 2 1st Grade Male 2 Grade Gender Grade_Gender_n Grade_n Proportion 12th Grade Female 2 5 0.4 12th Grade Male 3 5 0.6 1st Grade Female 2 4 0.5 1st Grade Male 2 4 0.5 Anytime you need to include an aggregation value in formula, we need to specify any grouping information for calculating the aggregate. The code for this is to specify the grouping variable and the aggregation function and column. The code is: {FIXED [Group]: SUM[Value]} 1.4.7 Unions One way that we could “squish” two data sets together is if they have the same columns and we essentially just want to add new rows to a data set. In this example we have two tables with identical column names and types and we just want to stack the two tables to create a single table that contains all the rows of data. Parents PersonID Type Handle P0001 email derek.sonderegger@nau.edu P0001 Twitter @D_Sonderegger P0002 email aubrey.sonderegger@yahoo.com Kids PersonID Type Handle P0003 email Elise.Sonderegger@gmail.com P0003 Twitter @UnicornsRule Taking a union of these two data sets just squishes them together vertically. Parents &amp; Kid Unioned Together PersonID Type Handle P0001 email derek.sonderegger@nau.edu P0001 Twitter @D_Sonderegger P0002 email aubrey.sonderegger@yahoo.com P0003 email Elise.Sonderegger@gmail.com P0003 Twitter @UnicornsRule 1.4.8 Joins There are many cases where we have two or more data sets that are related and we need to squish them together to make a table with more columns. For example we might have a data set People that contains a unique numeric code for each person, first and last names, and birth dates. We might also have a data set of Contacts which has the person’s unique numeric code and the contact type and value. People PersonID First.Name Birthday P0001 Derek 01/10/1976 P0002 Aubrey 02/14/1980 P0004 Casey 02/14/2015 Contact Information PersonID Type Handle P0001 email derek.sonderegger@nau.edu P0001 Twitter @D_Sonderegger P0002 email aubrey.sonderegger@yahoo.com The PersonID column links the two tables. But when we now have to ask what we should do about Casey. There are really two options: Join Type Description Inner Join Only include rows for individuals that have information in both tables. Full Join Include a row for for every row in either of the tables being joined. In this case, it results in a row Casey being included, but the contact information being left empty. A join squishes the two data sets together horizontally while making sure the rows match up because of one matching column that occurs in each data set. The inner join only returns rows that have data in both data sets. Inner Join PersonID First.Name Birthday Type Handle P0001 Derek 01/10/1976 email derek.sonderegger@nau.edu P0001 Derek 01/10/1976 Twitter @D_Sonderegger P0002 Aubrey 02/14/1980 email aubrey.sonderegger@yahoo.com The outer join returns all possible rows that occur in either data set. Notice that Casey has a row in the People data set but doesn’t have a corresponding row in the Contacts table. So his row in the outer join has missing data for the contact information. Outer Join PersonID First.Name Birthday Type Handle P0001 Derek 01/10/1976 email derek.sonderegger@nau.edu P0001 Derek 01/10/1976 Twitter @D_Sonderegger P0002 Aubrey 02/14/1980 email aubrey.sonderegger@yahoo.com P0004 Casey 02/14/2015 NA NA 1.5 Exercises We are given information about the maximum daily temperature from a weather station in Flagstaff, AZ. The file is available at the GitHub site that this book is hosted on. You can find it https://github.com/dereksonderegger/141/raw/master/data-raw/FlagMaxTemp.csv. This file is in a wide format, where each row represents a month and the columns 1, 2, …, 31 represent the day of the month the observation was made. Convert data set to the long format where the data has only four columns: Year, Month, Day, Tmax. Calculate the average monthly maximum temperature for each Month in the dataset (So there will be 365 mean maximum temperatures). There are several days that have missing data, represented by the value NA. If you have a problem taking the mean with them in there, you likely haven’t converted the temperature from a character string to a numeric value. Convert the average month maximums back to a wide data format where each line represents a year and there are 12 columns of temperature data (one for each month) along with a column for the year. There will be a couple of months that still have missing data because the weather station was out of commission for those months and there was NO data for the entire month. Save this table as a .csv file. A common task is to take a set of data that has multiple categorical variables and create a table of the number of cases for each combination. An introductory statistics textbook contains a dataset summarizing student surveys from several sections of an intro class. The two variables of interest for us are Gender and Year which are the students gender and year in college. Download the dataset as a .csv file from the following website: http://www.lock5stat.com/datasets/StudentSurvey.csv Notice that there are two survey responses that did not give their year in school. Perform a filter step to remove any row with the value of null in the Year column. Produce a data set with eight rows that contains the number of responses for each gender:year combination. Using a pivot command, produce a table of the number of responses in the following form: Gender First Year Sophmore Junior Senior Female Male Save this table as a .csv file. Read Chapter 2 in The Truthful Art. On page 46, figure 2.2 asks you to list aspects of the figure that “seem fishy”. Before reading the rest of the chapter, list the things that seem fishy. After you’ve read the rest of the chapter, go back and examine the graph and reflect on why you didn’t notice certain deceptive issues on the first reading of the graph. On page 55, figure 2.11 asks which chart is more aesthetically pleasing? Which do you think is more attractive and why? "],
["2-graphing-principles.html", "Chapter 2 Graphing Principles 2.1 Elementary Perception Tasks 2.2 Groupings / Gestalt 2.3 “Color” Scales 2.4 Exercises", " Chapter 2 Graphing Principles 2.1 Elementary Perception Tasks Some Visual tasks are easier than others because our visual processing evolved to do certain tasks. From Alberto Cairo’s “The Truthful Art” 2.2 Groupings / Gestalt The way we organize our graphics can lead a viewer to create mental groups of marks. The way we form groupings can be in one of the following ways, (where higher grouping methods produce a stronger grouping effect. Enclosures Connections Proximity Similarity (color/shape) In the following example, find all the fives: If instead, we form a grouping by adding color, then the group of fives stands out prominently. This example was inspired by an example by Alberto Cairo. 2.2.1 Grouping Examples In the following examples, ask yourself what the visual grouping the graph is encouraging? Are the rows or columns grouped? These are taken from a presentation by Todd Iverson and Silas Bergen. Some grouping is stronger than others 2.2.2 Example: Warpbreaks While spinning wool into thread, if the tension on the wool isn’t correctly set, the thread can break. Here we compare two different types of wool at three different tensions. 2.3 “Color” Scales Defining Color really has three different attributes (From Wikipedia). 2.3.0.1 HSV Scale Hue: The attribute of a visual sensation according to which an area appears to be similar to one of the perceived colors: red, yellow, green, and blue, or to a combination of two of them. Saturation: The “colorfulness of a stimulus relative to its own brightness” Value: The “brightness relative to the brightness of a similarly illuminated white” HSV Cylinder from Wikipedia Hue is appropriate for categorical variables. Saturation and/or Value is appropriate for a quantitative variable scale. Neither R nor Tableau make it particularly easy to map these aspects, so we won’t get too deep into it. 2.4 Exercises In soccer, Kylian Mbappé is being referred to as the next world dominating player. The graphic below compares Mbappé to soccer greats Cristiano Ronaldo and Lionel Messi. Below is a graph showing the number of goals scored during various parts of their career (first 100 professional games, second 100, etc). Mbappé vs Messi and Ronaldo Identify the EPT the reader is required to perform and the grouping structures used. Comment on how the grouping was effective or if you think some change might be better. In NBA basketball, shot accuracy and distance from the net is important. In the following graph, we can investigate how often shots are taken from different distances. Shot distribution in the NBA Identify the EPT the reader is required to perform and the grouping structures used. Comment on how the grouping was effective or if you think some change might be better. The following graphic calculates difference between a month’s temperature compared to the monthly average temperature across the years since 1850. For example, this graph compares the average January 2014 temperature to the average January temperature across the last 170 Januaries.) Average World Temperature Since 1850 Identify the EPT the reader is required to perform and the grouping structures used. Comment on how the grouping was effective or if you think some change might be better. Find a graphic “in the wild” that you think is interesting. Turn in both the original graphic as well as your answers to the following: Identify the EPT the reader is required to perform and the grouping structures used. Comment on how the graph was effective or if you think some change might improve the graph. "],
["3-amounts-proportions.html", "Chapter 3 Amounts &amp; Proportions 3.1 Introduction 3.2 Example 1 3.3 Example 2 3.4 Tableau Toolbox 3.5 Example 3 3.6 Proportions 3.7 Single Set 3.8 Multiple Sets of Proportions 3.9 Exercises", " Chapter 3 Amounts &amp; Proportions 3.1 Introduction This chapter focuses on displaying a single numerical variable versus one or more categorical variables. To display the quantitative variable, we’ll try to stay at the top of the EPT tasks and the quantitative variable will be quantified with either the x or y axis or using length. The exception to this is the heatmap, where the quantitative variable is encoded by the color of the tile. 3.2 Example 1 The 2020 presidential candidate field has a wide range of ages. The New York Times has a nice article showing the candidate ages. I grabbed a few of the most prominent candidates and pulled their birthdays from Wikipedia and then calculated their age on election day. As usual the data is available on the Github pages for this book. The order of the candidates is useless. Here we have ordered them alphabetically when we should try to think about an ordering that improves clarity. Lets switch to sorting the candidates by age. This isn’t too bad, but it fails to visually impress the differences. A bar chart should visually impress the ages based on the length of the bar so that we don’t have to keep looking at the Age axis. What would be dishonest is if we were to chop off the bars at 35 or 40 to make the age difference between Buttigieg and Warren, Trump, Biden and Sanders seem huge. 3.3 Example 2 In this section we’ll consider two categories. We have the results from a survey administered to students in an introductory statistics class at a New York university. We’ll compare the number of student responses broken down by year in school and gender. The first thing I notice is that there is approximate gender equality, but there are a few more males in class. After a more detailed look, I see that the most abundant class is sophomores, followed by first years, and juniors and seniors are approximately equally abundant. If we switch the grouping order and use color to denote gender and columns to denote the classes, the abundance of sophomores is the first insight to be noticed. 3.4 Tableau Toolbox 3.5 Example 3 Often we need to graph some value and want to know how it varies among two different categories. In these cases, we have to employ some sort of grouping strategy. The bar chart here is obscuring the differences in life expectancies because the numbers are so close. In this case, I think points make more sense. Also I want to see how life expectancy has changed since World War II. In the above graph, I am grouping countries both by enclosure and with a physical path connection. The reader tends to see the line as a whole object and compare the line max/min and slope among the seven countries. We might consider changing the faceting to stack the countries, but this makes it much harder to compare countries to see which has a higher life expectancy. We could have also used color to indicate which country is which, but this produces a bit of a spaghetti plot and is difficult to interpret. However, it is easier to identify when Japan’s life expectancy surpassed the rest of the G7 countries. A heat map makes it easier to see which country has the highest life expectancy, but we lose precision in the actual values. 3.6 Proportions Conceptually graphing proportions is the same as graph raw values, but sum to 100%. This seemingly small difference means that our graphic can imply that our categories contain ALL possible categories. 3.7 Single Set 3.7.1 Pie Charts ## Parsed with column specification: ## cols( ## Type = col_character(), ## Number = col_double() ## ) As typical, with a just a few categories, we should move the labels onto the graph and just annotate the graph. Also, we’ll order the categories from the most temporary employees (Graduate Teaching Assistants) to most permanent (Professors) 3.7.2 Stacked Bar 3.7.3 Side-by-side Barchart Pie chart Stacked bars Side-by-side bars Clear that data is proportions of a whole Yes Yes no Precise visual comparison of values no no Yes Visually appealing even in simple comparisons Yes no Yes Extendable to nested or multiple distributions or time series no Yes no 3.8 Multiple Sets of Proportions 3.8.1 Faceted Bar charts ## Warning: Removed 4 rows containing missing values (position_stack). 3.8.2 Side-by-Side Stacked Barcharts 3.8.3 Mosiac plots Sort like side-by-side stacked bar charts, but now we allow the column width to vary as well. The area is proportional the groups representation in the whole data. This reduces the number of really thin bands because we can make the column narrower as well. 3.8.4 Alluvial Plots If we want to compare multiple categorical variables, another option is alluvial plots. ## Warning in to_lodes_form(data = data, axes = axis_ind, discern = ## params$discern): Some strata appear at multiple axes. ## Warning in to_lodes_form(data = data, axes = axis_ind, discern = ## params$discern): Some strata appear at multiple axes. ## Warning in to_lodes_form(data = data, axes = axis_ind, discern = ## params$discern): Some strata appear at multiple axes. ## Warning: The parameter `label.strata` is deprecated. ## Pass arguments to `infer.label` instead. I find that alluvial plots work better for events that have a definate chronological order and there is less stream overlaps.. Here is an example from a Washington Post story about people graphing their online dating interactions. These are the results of 6.5 weeks of online dating by a 37 year old woman. 3.8.5 Tree graphs In mosaic plots, we had crossed variables where every category level of one factor could show up with all levels of another factor. Crossed Factors Suitable for a Mosaic Plot. Factor.1 Factor.2 value A w 4 A x 6 B w 15 B x 25 Another possibility is that the variables are nested such that a category level of the second factor only ever occurs within a single level of the first factor. Nested Factors Suitable for a Tree Map. Factor.1 Factor.2 value A w 4 A x 6 B y 15 B z 25 When we have a hierarchical structure of categories, then mosaic plots aren’t quite right. Instead we’ll hierarchically subdivide the graph area up. The graph first separates the graph into continents and scales the area of each continent by the population of the continent. Then each continent is split into the countries that compose the continent, again with area representing population. Finally the countries are color-coded by their 2007 life expectancy. This differs from a mosaic plot in that a country only occurs withing one continent whereas in a mosaic plot, a category level will occur in multiple “containers”. The previous graph is pretty ugly because we are trying to code two quantitative variables (population size and life expectancy). We’ll concentrate on population size. Instead of using text to indicate both the continent and country, lets use text for the country and color for continent. 3.9 Exercises Alluvial plots are a particular type of Sankey graphs which show flow rates and amounts and have been around for quite some time. In 1869, Charles Minard created a graphic that details the size of Napoleon’s army as they marched on Russia and subsequently returned. You can find the original or the modern English translation on Wikipedia. How many men did the army start marching with? How many men arrived in Moscow? How many men died crossing the Berezina River on the return trip? (approximately from the map information provided) How cold was it when they cross the Berezina River on the return trip? Read Chapter 10 and 11 in Claus Wilke’s Fundamentals of Data Visualization book. In chapter 11 he presents several different graphics that visualize the bridge construction era, bridge material, and which river they cross for bridges near Pittsburgh, Pennsylvania. Discuss three of them and explain which graph you prefer and why. Download data about the Titanic disaster at the GitHub site for this class. Save the file as a Titanic.csv and open it in Tableau. In Tableau, a faceted stacked barchart just as we did in these notes. In a new worksheet, copy your faceted stacked bar chart and then turn it into faceted pie charts. Comment on which you prefer and why. Finally create a mosaic plot of the Titanic dataset. "],
["4-distributions.html", "Chapter 4 Distributions 4.1 Many distributions", " Chapter 4 Distributions Given a single variable, we often want to know what values are common and what values are rare. To visualize this, we will primarily compare marks along a common axis (the most accurate EPT). The only question is we have is how indicate how common particular values are. 4.0.1 Small samples If we only have a few observations, then we can just graph them along an axis. If we have too many data points, we’ll have problems with over-plotting. Another trick that works with more data, is to not use dots but rather lines. This is called a rugplot. The smaller width of the lines reduces, but don’t completely mitigate, the overplotting issue. A rugplot layer is often used in conjunction with another graph such as a scatterplot. 4.0.2 Histograms When we have a moderate size of data, graphing dots exactly on an axis doesn’t work and results in overplotting and it is difficult to see where the data cluster. Instead we’ll stack the dots in columns along the axis and call this a dotplot. Each dot represents an observation, but the x-values have been rounded into group values. So we have lost some precision. Another common version of this is a histogram, where the y-axis represents how many observations fall into each bin. The choice of how many bins to include can make a dramatic difference in a graph. In particular, I don’t believe that there is any biological reason to think the dip near 2700 grams is real. I believe that is is actually just an artifact of the data I have. Instead we should consider changing the number of bins. 4.0.3 Density plots Histograms suffer from being to angular or pointy. Another solution is call a kernel density smoother that mathematically smooths over the heights of the histogram bars. 4.0.4 Faceting One of my favorite ways to display multiple distributions is to group each distribution into it’s own plot in a process often referred to as faceting. By choosing to put the two graphs on top of the other, it becomes clear that the smoker’s tend to give birth to smaller infants. This fact isn’t clear in the side-by-side graphs. 4.0.5 Stacking Stacking the distribution involes laying each distribution on top of each other, so that the zero of the top curve follows the curve on the bottom. You can visualize the B chart having the Non-smoker density graph just melt onto the smoker density. I really don’t like this graph because it is very hard to see where the peak of the non-smoker curve is. This stacking trick works well enough when we have proportions but isn’t good here. 4.0.6 Overlapping curves Another option is to graph the densities, but allow them to overlap each other and be a bit see-thru. For seeing shifts in the center of the distribution, overlapping curves is quite powerful. 4.1 Many distributions Next we’ll consider comparing many different distributions. In our example, we’ll investigate the daily maximum temperature in Lincoln Nebraska in 2016 and we show the temperature distribution for each month. Therefore we’ll have 12 different distributions to compare. 4.1.1 Boxplots Boxplots are a traditional way to display a distribution and the box contains the middle 50% of the data points. While boxplots are quite commonly used, they summarize the data too much and a lot of interesting detail is lost in this summary. 4.1.2 Ridge Plots If we have a bunch of overlapping curves, but we stagger them along the y-axis, we get a type of graph called a ridge graph. Notice that in density plots, there were two peaks in December with the lower peak corresponding to a cold snap. That detail is lost in the boxplots. 4.1.3 Violin Plots An alternative to ridge plots a graph called a violin plot. This takes the density plots and mirrors them. Then we’ll display them with no overlap in the different distributions. Now we can see the two peaks in December, but the three peaks in November have been flattened out because the amount of space necessary to show it would require that the densities overlap. Ridgeline and violin plots are great alternatives to box plots and the choice to have the density plots overlap or not is up to the user. "],
["5-x-y-relationships.html", "Chapter 5 X-Y Relationships 5.1 Scatter plots 5.2 Correlation Plots 5.3 Overplotting 5.4 Exercises", " Chapter 5 X-Y Relationships 5.1 Scatter plots Basic idea is to build off of a scatter plot. This visualizes the relationship between two continuous variables. In a scatter plot we can see the relationship between two variables. We can see the relationship among more variables (either continuous or discrete) by adding Size, Color, and Shape. We could also add other categorical variables by adding faceting. With this combination we can visualize the relationship between up to 6 different variables. 5.1.1 Pairs plots (All-vs-all scatterplots) Sometimes we have a dataset with several different variables of quantitative variables. One thing we could do is just make all possible pairs of scatterplots. In a pairs plot, we make a grid of graphs where x-axis or y-axis remains consistent as we move across the columns or rows of the grid. 5.2 Correlation Plots 5.2.1 Pearson’s Correlation Coefficient We first consider Pearson’s correlation coefficient, which is a statistics that measures the strength of the linear relationship between the predictor and response. Consider the following Pearson’s correlation statistic \\[r=\\frac{\\sum_{i=1}^{n}\\left(\\frac{x_{i}-\\bar{x}}{s_{x}}\\right)\\left(\\frac{y_{i}-\\bar{y}}{s_{y}}\\right)}{n-1}\\] where \\(x_{i}\\) and \\(y_{i}\\) are the x and y coordinate of the \\(i\\)th observation. Notice that each parenthesis value is the standardized value of each observation. If the x-value is big (greater than \\(\\bar{x}\\)) and the y-value is large (greater than \\(\\bar{y}\\)), then after multiplication, the result is positive. Likewise if the x-value is small and the y-value is small, both standardized values are negative and therefore after multiplication the result is positive. If a large x-value is paired with a small y-value, then the first value is positive, but the second is negative and so the multiplication result is negative. The following are true about Pearson’s correlation coefficient: \\(r\\) is unit-less because we have standardized the \\(x\\) and \\(y\\) values. \\(-1\\le r\\le1\\) because of the scaling by \\(n-1\\) A negative \\(r\\) denotes a negative relationship between \\(x\\) and \\(y\\), while a positive value of \\(r\\) represents a positive relationship. \\(r\\) measures the strength of the linear relationship between the predictor and response. 5.3 Overplotting 5.3.1 Transparency Wilke’s book uses and example of departure time of day versus the delay amount for all the flights out of New York City in 2013. The story to take home is that longer delays tend to happen later in the afternoon or evening rather than in the morning. Wilke uses these data to argue that overplotting is annoying and that a heat map can help out. 5.3.2 Intensity Maps No matter how much we adjust the transparency, we can’t really fix this because there is so much data. If for each area on the graph, we count how many observations fall into the region, we can color the area based on how many observations are in the region. This graph leads me to think that MOST flights are quite late, when if fact, they aren’t. This is due to the problem of “proportional pixels”. There is so much space and color devoted to flights that are more than 30 minutes late that the viewer can’t help but have that impression. delay n proportion (-30,-10] 12465 0.03794 (-10,0] 187620 0.5711 (0,10] 45598 0.1388 (10,30] 34543 0.1051 (30,60] 21710 0.06608 (60,120] 16858 0.05132 (120,180] 5830 0.01775 (180,Inf] 3893 0.01185 Because we are interested in the time distribution of significant delays, and early departures are usually only by a couple of minutes, we’ll we’ll take a log\\(_{10}\\) transformation of all the delays greater than 10 minutes. We’ll also modify the color scale so that hexagons with a small count fade into the background and are white and hexagons with relatively large counts have a noticable color. 5.3.3 Contour Plots Contour plots are similar to density plots, but for two-axis. The lines mark out regions of similar probability and we read it similarly as a topological map that shows elevation. In this case we can see that the most frequent delays are around 30 minutes long and occur near 5 pm. There is also a local peak of 20 minute delays around 10 am. 5.4 Exercises Read Chapters 12 and 18 from Wilke’s book. Feel free to skip section 12.3. We will use a smaller version of the diamonds dataset that Wilke uses in his Chapter 18. You can download it from my GitHub site in a .csv file. We will examine price, carats, cut (Fair, Good, Very Good, Premium, and Ideal), color (J - D), and clarity (I1, SI2, SI1, VS2, VS1, VVS2, VVS1, IF), where the category labels I’ve given are from worst to best. Had I not told you that clarity level IF is the best clarity, what graphs could you make to figure that out? Create and show a graph that demonstrates this and explain your graph. If the diamond clarity isn’t good, the dimond cutter won’t worry too much about the quality of cut. Make a graph that demonstrates that and explain your reasoning. While in principle it is possible for the dimond carats to be any number, they are often cut to be some common carat size. Create a visualization that shows this and discuss how the carat size changes as the cut and clarity improve. From the Gapminder.com website, I’ve downloaded a bunch of interesting covariates about countries. You can find my dataset at my GitHub site in a .csv file. The variables I’ve included include the country region, year, population size, population growth, percent of population with basic sanitation, GDP per capita, Total GDP, life expectancy, adult male and female labor force participation rates. Fertility is the number of children per woman, so a fertility rate of 2 children per woman is a stable population. For all the following questions, only consider the year 2015. Investigate the relationship between GDP and GDP_per_capita. Why should we prefer to work with GDP_per_capita when comparing standards of living between, say, the United States and Canada? Investigate the relationship between life expectancy, fertility, and GDP_per_capita. Do these relationships seem to vary by region? Comment on your graphs and relationships that you observe. Investigate the relationship relationship between life expectancy, adult female labor force participation and fertility. Does this vary by region? Comment on your graphs and relationships that you observe. "],
["6-geographic.html", "Chapter 6 Geographic 6.1 Map Layers 6.2 Tableau", " Chapter 6 Geographic The usual map of the world that is shown is highly misleading. Because we have to project a spherical object onto a 2-D plane, we can’t do it without distorting the areas. The result is that areas near the north and south poles look much larger than they actually are. This ends up emphasizing high latitude European countries compared to equatorial countries. The True Size Here are the three most commonly used projections: Equirectangular has an even grid of latitude and logitude lines. The Robinson projection is a compromise that tries to re-scale land near the poles to be closer to the actual size. Another compromise is to allow for discontinuities on the map surface. This decreases the amount of distortion, but cleaves Greenland and Antarctica. I haven’t had an opportunity to place my own spin on geographic maps and instead we will look at Claus Wilke’s Chapter on Geographic maps. One of the best things about interactive maps is that you can zoom in and out and change the level of resolution. The ability to easily transition between different scale is amazing and is a hallmark of a quality interactive experience. Google Maps is built on a 256x256 pixel tile system where zoom level 0 is an image of the whole earth. Each zoom step in halves the X and Y range and so shows 1/4 of the surface area. Zoom level 20 is the scale of a single building, level 14 is the zoom level displayed above. 6.1 Map Layers Most maps that are viewed have multiple sources and types of data displayed. In most software that specifically handles maps, we have the option of adding multiple data types to build up a custom map. From a blank map, we could: Add a layer showing ocean/landmass divisions. Add a layer showing country borders. Add a layer showing state/province borders within countries. Add a layer showing land type (forest, etc) Add a layer showing major cities. Add a layer showing major roads. Add a layer showing major water-ways. Fortunately there are many map creation sites that easily allow you to specify a location via the latitude and longitude coordinates and will display maps with the above layers already added. 6.2 Tableau The mapping within Tableau is unfortunately limited. We can’t easily create map layers and overlay them, but Tableau does a great job at taking data sets with a small amount of geographical information (e.g. country names, state/provinces, or even county names) and recognizing them as geographical data and making maps that show those and easily filling in the geo-political region. "],
["7-what-to-graph.html", "Chapter 7 What to Graph 7.1 Total 35% 38% 38.75% 34.4% 7.2 Maternity Deaths 7.3 Exercises", " Chapter 7 What to Graph This week we start asking “What” to graph instead of just “How” to graph. Example: Vehicle Deaths Example: Should we be using GDP to measure economic “success”? Example: Tim Cook displaying total iPhone sales instead of quarterly sales. Example: Age Standardization Suppose we have two populations with the following age structures and proportion that believe that vaping is “very harmful”. Suppose that in each population we’ve asked if individuals believe that vaping is “very harmful”. Population Agree A 0.35 B 0.3798 However It turns out that Population B has a much older population. Here I am considering population sizes of 100 individuals just to make the math convenient, but these could be arbitrary population sizes. Population Sizes Age A B 18-29 40 10 30-49 30 20 50-64 20 30 65+ 10 40 Is Vaping Harmful? (By age group and population). Here we see that, by age group, people in population B tend to be more permissive opinion about vaping than population A. Age A B 18-29 30-49 50-64 65+ Total 40 (0.25) 30 (0.4) 20 (0.4) 10 (0.5) 0.35% 10 (0.2) 20 (0.35) 30 (0.366) 40 (0.45) 0.38 What if Population A had the same demographics as Population B? Lets calculate the “Average Demographic Distribution” and then do the multiplication. Age A B A.Std B.Std 18-29 30-49 50-64 65+ 40 (0.25) 30 (0.4) 20 (0.4) 10 (0.5) 10 (0.2) 20 (0.35) 30 (0.366) 40 (0.45) 25 (0.25) 25 (0.4) 25 (0.4) 25 (0.5) 25 (0.2) 25 (0.35) 25 (0.366) 25 (0.45) 7.1 Total 35% 38% 38.75% 34.4% Next we consider an example of where this might be helpful. Our example comes from a website “Our World in Data” which tries to provide useful data sets and analysis to address major societal issues. Here we will consider suicide rates in different countries around the world. 7.2 Maternity Deaths Suppose that we are interested the mortality rates that women experience related to pregnancy and birth. Step One: Variable of interest Clearly we want to have some sort rate adjustment to account for different population sizes. However, because not all women give birth, we shouldn’t just consider all women. Instead we’ll consider this maternal deaths per 100,000 live births. Step Two: Context Approximately 700 women per year die due to complications of pregnancy or child birth in the United States. This turns out to be ~17.2 deaths per 100,000 births, or about 1 maternal death per 5,000 live births. Step Three: Conditional Statistics - How does this vary between countries? - How does this vary between states? - How does this vary between socio-economic or ethic groups? Step Four: Finding Data - Typically it is easy to google for a single statistic for a country. However, it is often difficult to find a dataset that allows for the conditional statistics, such as between states or ethnic groups. - I found data from the Centers for Disease Control. The CDC’s Wonder on-line access allows you to format data requests for a wide variety of scenarios. Now we find some data from the CDC… - Problem: Can’t get State by Year data due to confidentiality… - Year by race? 7.3 Exercises Download from the STA 141 GitHub raw data directory files for the murders per state as well as population sizes of each state. The murder information data file contains information about the number of murders per state, how many of those murders were gun related, and the rate of gun ownership. I got this information from Wikipedia, and it isn’t clear if gun ownership rate is the percent of residents that owns one or more gun or if it is the number of guns per state divided by the number of residents. Join the state population and murder information data sets. Calculate the murder rate and gun murder rate for each statement per 100,000 residents. Make a scatterplot of gun ownership rate vs the gun murder rate. Download from the STA 141 GitHub raw data directory files for the suicide rates per state. Join this data to data you used in problem 1. Create a scatterplot graph of suicide rate vs gun ownership rates. Given the context of the problems (1) and (2), what follow-up questions come to mind? Given at least two follow-up questions and the graphs you would create to address those questions. Identify the data you would need to create such a graph. Context: At this point, you are not expected to find the data, but identify what variables of interest you would need. Propose a topic of interest to you and consider what variables you would need to obtain to explain it to your fellow classmates in a series of one or more graphics. In particular, discuss how the variables you chose needed (or will need) to be transformed to provide useful comparisons. "]
]
